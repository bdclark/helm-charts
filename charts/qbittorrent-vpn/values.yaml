# -- Override the release name.
nameOverride: ""
# -- Override the full release name.
fullnameOverride: ""

# -- Number of replicas.
replicaCount: 1

# -- Deployment update strategy.
strategy:
  type: Recreate

# -- Image pull secrets.
imagePullSecrets: []

# -- Annotations for the Deployment.
deploymentAnnotations: {}

# -- Additional labels for the Deployment.
extraDeploymentLabels: {}

# -- Annotations for pods.
podAnnotations: {}

# -- Additional labels for pods.
podLabels: {}

# -- Pod security context.
podSecurityContext: {}
  # fsGroup: 2000

# qBittorrent configuration
qbittorrent:
  image:
    # -- Image repository.
    repository: lscr.io/linuxserver/qbittorrent
    # -- Image tag (defaults to chart appVersion).
    tag: ""
    # -- Image pull policy.
    pullPolicy: IfNotPresent

  # -- Container security context.
  securityContext: {}
    # capabilities:
    #   drop:
    #   - ALL
    # readOnlyRootFilesystem: true
    # runAsNonRoot: true
    # runAsUser: 1000

  # -- Resource requests and limits.
  resources: {}
    # limits:
    #   cpu: 100m
    #   memory: 128Mi
    # requests:
    #   cpu: 100m
    #   memory: 128Mi

  # -- Container ports.
  ports:
    - name: http
      containerPort: 8080
      protocol: TCP

  # -- Startup probe configuration.
  startupProbe: {}
  # -- Liveness probe configuration.
  livenessProbe: {}
    # httpGet:
    #   path: /
    #   port: http
  # -- Readiness probe configuration.
  readinessProbe: {}
    # httpGet:
    #   path: /
    #   port: http

  # -- Environment variables.
  # @default -- `{}` (see values.yaml comments for examples)
  env: {}
    # TZ: Etc/UTC
    # PUID: "1000"
    # PGID: "1000"
    # MY_PASSWORD:
    #   valueFrom:
    #     secretKeyRef:
    #       name: mysecret
    #       key: password
    # MY_CONFIG_VALUE:
    #   valueFrom:
    #     configMapKeyRef:
    #       name: my-config
    #       key: config_value

  # -- Environment variables from ConfigMaps or Secrets.
  envFrom: []
    # - configMapRef:
    #     name: qbittorrent-vpn-env
    # - secretRef:
    #     name: qbittorrent-vpn-secret-env

  config:
    # -- Directory containing the configuration file.
    mountPath: /config/qBittorrent
    # -- Configuration file name.
    fileName: qBittorrent.conf

    bootstrap:
      # -- Create config file if missing.
      # Requires persistence.config.enabled=true.
      enabled: false

      # -- Initial configuration content (used when existingConfig.type is empty).
      # @default -- Sane defaults for containerized deployment.
      config: |-
        [LegalNotice]
        Accepted=true

        [Preferences]
        Connection\UPnP=false
        Connection\PortRangeMin=6881
        Downloads\SavePath=/data/
        Downloads\TempPath=/data/incomplete/
        WebUI\Address=*
        WebUI\ServerDomains=*

      existingConfig:
        # -- Source type for existing config: "configMap", "secret", or "" (use bootstrap.config).
        type: ""
        # -- Name of the ConfigMap or Secret.
        name: ""
        # -- Key containing the configuration data.
        key: qBittorrent.conf

      webuiPassword:
        # -- Password injection mode: "disabled", "ifMissing", or "overwrite".
        # Requires bootstrap.enabled=true.
        mode: disabled
        existingSecret:
          # -- Secret name containing the PBKDF2-hashed password.
          name: qbittorrent-webui
          # -- Secret key for the password.
          key: WebUI_Password_PBKDF2

  # Persistent storage
  persistence:
    config:
      # -- Enable config persistence.
      enabled: true
      # -- Mount path.
      mountPath: /config
      # -- Subdirectory of the volume to mount (optional).
      subPath: ""
      # -- Storage class ("-" for default, "" for cluster default).
      storageClass: ""
      # -- Access modes.
      accessModes:
        - ReadWriteOnce
      # -- Volume size.
      size: 2Gi
      # -- Use existing PVC (disables provisioning).
      existingClaim: ""
      # -- PVC annotations.
      annotations: {}
        # k8up.io/backup: "true"

    data:
      # -- Enable data persistence.
      enabled: false
      # -- Mount path.
      mountPath: /data
      # -- Subdirectory of the volume to mount (optional).
      subPath: ""
      # -- Storage class ("-" for default, "" for cluster default).
      storageClass: ""
      # -- Access modes.
      accessModes:
        - ReadWriteOnce
      # -- Volume size.
      size: 2Gi
      # -- Use existing PVC (disables provisioning).
      existingClaim: ""
      # -- PVC annotations.
      annotations: {}
        # k8up.io/backup: "true"

  # -- Additional volume mounts.
  volumeMounts: []
  # - name: foo
  #   mountPath: "/etc/foo"
  #   readOnly: true

  service:
    # -- Service type.
    type: ClusterIP
    # -- Service port.
    port: 8080

  # Ingress configuration
  ingress:
    # -- Enable Ingress.
    enabled: false
    # -- Ingress class name.
    className: ""
    # -- Ingress annotations.
    annotations: {}
      # kubernetes.io/ingress.class: nginx
      # kubernetes.io/tls-acme: "true"
    # -- Ingress hosts.
    hosts:
      - host: qbittorrent.local
        paths:
          - path: /
            pathType: ImplementationSpecific
    # -- Ingress TLS configuration.
    tls: []
    #  - secretName: chart-example-tls
    #    hosts:
    #      - chart-example.local

# VPN sidecar configuration
gluetun:
  # -- Enable VPN sidecar.
  enabled: true

  # -- Lifecycle mode: "nativeSidecar" or "standard".
  # Native sidecars (initContainer with restartPolicy Always) require Kubernetes 1.29+.
  lifecycleMode: "nativeSidecar"

  # -- Container lifecycle hooks.
  lifecycleHooks: {}

  image:
    # -- Image repository.
    repository: qmcgaw/gluetun
    # -- Image tag.
    tag: v3.41.0
    # -- Image pull policy.
    pullPolicy: IfNotPresent

  # -- Mount /dev/net/tun device.
  needsTunDevice: true

  # -- Container security context.
  securityContext:
    capabilities:
      add:
        - NET_ADMIN

  # -- Resource requests and limits.
  resources: {}
    # limits:
    #   cpu: 100m
    #   memory: 128Mi
    # requests:
    #   cpu: 100m
    #   memory: 128Mi

  # -- Container ports.
  ports: []
    # - name: openvpn
    #   containerPort: 1194
    #   protocol: UDP

  # -- Startup probe configuration.
  startupProbe: {}
  # -- Liveness probe configuration.
  livenessProbe: {}
  # -- Readiness probe configuration.
  readinessProbe: {}

  # -- Environment variables.
  # @default -- `{}` (see values.yaml comments for examples)
  env: {}
    # TZ: Etc/UTC
    # PUID: "1000"
    # PGID: "1000"
    # MY_PASSWORD:
    #   valueFrom:
    #     secretKeyRef:
    #       name: mysecret
    #       key: password
    # MY_CONFIG_VALUE:
    #   valueFrom:
    #     configMapKeyRef:
    #       name: my-config
    #       key: config_value

  # -- Environment variables from ConfigMaps or Secrets.
  envFrom: []
    # - configMapRef:
    #     name: gluetun-env
    # - secretRef:
    #     name: gluetun-secret-env

  # Persistent storage
  persistence:
    # -- Enable persistence.
    enabled: false
    # -- Storage class ("-" for default, "" for cluster default).
    storageClass: ""
    # -- Access modes.
    accessModes:
      - ReadWriteOnce
    # -- Volume size.
    size: 200Mi
    # -- Use existing PVC (disables provisioning).
    existingClaim: ""
    # -- PVC annotations.
    annotations: {}
      # k8up.io/backup: "true"

  # -- Additional volume mounts.
  volumeMounts: []
  # - name: foo
  #   mountPath: "/etc/foo"
  #   readOnly: true

  # Control server authentication configuration
  # See: https://github.com/qdm12/gluetun-wiki/blob/main/setup/advanced/control-server.md
  controlServer:
    # -- Enable control server authentication config file.
    enabled: false
    # -- Mount path for the auth config directory.
    mountPath: /gluetun/auth
    # -- Config file name.
    fileName: config.toml

    existingSecret:
      # -- Name of an existing Secret containing the TOML config.
      # If empty and config is set, a Secret will be created from the inline config.
      name: ""
      # -- Key within the Secret.
      key: config.toml

    # -- Inline TOML config. Creates a chart-managed Secret when
    # existingSecret.name is empty. Visible in Helm values/history,
    # so not recommended for production.
    # @default -- "" (disabled)
    config: ""
    # Example:
    # config: |
    #   [[roles]]
    #   name = "qbittorrent"
    #   routes = ["GET /v1/portforward"]
    #   auth = "apikey"
    #   apikey = "your-api-key"

  # Control server service configuration
  service:
    # -- Enable gluetun control server service.
    enabled: false
    # -- Service type.
    type: ClusterIP
    # -- Service port.
    port: 8000

# -- Additional init containers (run before gluetun if native sidecar mode).
initContainers: []

# -- Additional containers.
extraContainers: []

# -- Additional volumes.
volumes: []
# - name: foo
#   secret:
#     secretName: mysecret
#     optional: false

# -- Node selector.
nodeSelector: {}

# -- Tolerations.
tolerations: []

# -- Affinity rules.
affinity: {}
